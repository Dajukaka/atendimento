<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Guanabara Atendimento</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        body { font-family: sans-serif; background: #121212; color: #fff; text-align: center; margin: 0; padding: 20px; -webkit-tap-highlight-color: transparent; }
        h1 { color: #f39c12; text-transform: uppercase; letter-spacing: 2px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(70px, 1fr)); gap: 12px; max-width: 500px; margin: 20px auto; }
        button { height: 75px; border-radius: 15px; border: none; background: #222; color: #f39c12; font-size: 22px; font-weight: bold; box-shadow: 0 4px #000; cursor: pointer; }
        button.selecionado { background: #f39c12 !important; color: #fff !important; transform: translateY(4px); box-shadow: 0 0 15px #f39c12; }
        #status { position: fixed; top: 10px; background: #27ae60; padding: 10px 20px; border-radius: 30px; display: none; font-weight: bold; z-index: 100; }
    </style>
</head>
<body>

    <div id="status">ENVIADO!</div>
    <h1>GUANABARA</h1>
    <p>Toque no número para chamar</p>

    <div class="grid" id="painel"></div>

 <script>

        const firebaseConfig = {

            apiKey: "AIzaSyCJu0tGeJSMt-9HXRVT2Ijsdh-Z1NzJYmg",

            databaseURL: "https://guanabara-atendimento-default-rtdb.firebaseio.com"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // SOM EMBUTIDO (Bipe Curto)
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function tocarBipe() {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.type = "sine";
            osc.frequency.setValueAtTime(880, audioCtx.currentTime); // Tom do bipe
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.1); // Duração de 0.1 segundos
        }

        // GERAR BOTÕES
        const painel = document.getElementById('painel');
        for (let i = 1; i <= 85; i++) {
            let b = document.createElement('button');
            b.innerText = i;
            b.id = "m-" + i;
            b.onclick = () => enviar(i);
            painel.appendChild(b);
        }

        function enviar(n) {
            // DESTRAVAR ÁUDIO (Necessário para navegadores bloquearem menos)
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }
            
            tocarBipe();

            // Marcar botão
            document.querySelectorAll('button').forEach(btn => btn.classList.remove('selecionado'));
            document.getElementById('m-' + n).classList.add('selecionado');

            // Mostrar aviso
            const st = document.getElementById('status');
            st.innerText = "MÁQUINA " + n + " CHAMADA!";
            st.style.display = "block";
            setTimeout(() => { st.style.display = "none"; }, 2000);

            // Enviar Firebase
            db.ref('atendimento').set({
                maquina: n,
                hora: Date.now()
            });
        }
    </script>
</body>
</html>